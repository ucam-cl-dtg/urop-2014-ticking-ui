<!doctype html>
<html>
<head>
	<script src="../bower_components/platform/platform.js"></script>
	<link rel="import" href="../bower_components/font-roboto/roboto.html">
	<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
	<link rel="import" href="../elements/card.html">
	<style>
		html, body {
			font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
			margin: 0;
			width: 100%;
		}
	</style>
</head>
<body>
	<core-ajax id="loginAjax"
		url="http://urop2014.dtg.cl.cam.ac.uk/UROP_UI/api/raven/login"
		on-core-response="{{loginResponse}}">
	</core-ajax>
	<script>
		window.addEventListener('polymer-ready', function(e) {
	        var loginAjax = document.querySelector('#loginAjax');

	        // LDAP API response.
	        loginAjax.addEventListener('core-response', function(e) {
	        	var ldap = this.response;
	        	makeCard(ldap);
	        });

	        loginAjax.go(); // Call its API methods.
	    });
	    var makeCard = function(data) {
	    	var card = document.createElement('user-card');
	    	card.setAttribute('crsid', data.crsid);
	    	card.setAttribute('name', data.displayName);
	    	card.setAttribute('email', data.email);
	    	card.setAttribute('college', data.college);
	    	document.body.appendChild(card);
	    };
	</script>
</body>
</html>