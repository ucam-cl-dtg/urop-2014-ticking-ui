<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="date-calendar.html">
<link rel="import" href="slot-box.html">

<polymer-element name="upcoming-slots" attributes="slots">
	<template>
		<style>
			:host {
				display: block;
			}
			h1 {
				font-size: 1.8rem;
				font-weight: 100;
				padding: 0 0 0 10px;
			}
			slot-box {
				width: calc(100% / 3);
			}
			slot-box:nth-child(odd) {
				background: #f6f6f6;
			}
			slot-box:nth-child(even) {
				background: #e9e9e9;
			}
		</style>
		<div id="headerBar" layout horizontal center>
			<h1 flex>Upcoming Events ({{slots ? slots.length : 0}})</h1>
			<search-box id="searchBox" placeholder="Search..."></search-box>
		</div>

		<!-- Tick list. -->
		<div layout horizontal center wrap>
			<template repeat="{{slot in slots}}">
				<slot-box 	datetime="{{slot.startTime}}" 
							tickId="{{slot.comment}}" 
							ticker="{{slot.columnName}}">
				</slot-box>
			</template>
		</div>
	</template>
	<script>
		Polymer('upcoming-slots', {
			domReady: function () {
				this.slots = [
					{
						startTime: "2012-07-14T01:00:00+01:00",
						comment: "rmk35,tester",
						columnName: "Foo"
					},
					{
						startTime: "2012-07-14T01:00:00+01:00",
						comment: "rmk35,tester",
						columnName: "Foo"
					},
					{
						startTime: "2012-07-14T01:00:00+01:00",
						comment: "rmk35,tester",
						columnName: "Foo"
					}
				]
			},

			slotListFilter: function(items, q) {
				if (items && q) {
					return items.filter(this.slotFilter.bind(this));
				}
				return items;
			},

			slotFilter: function(item) {
				var q = this.$.searchBox.query.toLowerCase();
				return (item.tickId.toLowerCase().indexOf(q) > -1 ||
						item.ticker.toLowerCase().indexOf(q) > -1);
			},
		});
	</script>
</polymer-element>