<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="are-you-sure.html">

<polymer-element name="delete-group" attributes="">
	<template>

		<!-- Delete group API. -->
		<core-ajax id="deleteAPI"
			method="DELETE"
			url="{{'http://urop2014.dtg.cl.cam.ac.uk/UROP_UI/api/group/' + gid }}"
			on-core-response="{{deleteResponse}}"
			on-core-error="{{deleteError}}">
		</core-ajax>

		<!-- Confirmation dialog. -->
		<are-you-sure id="confirm"
			on-yes="{{deleteConfirmed}}"></are-you-sure>

		<!-- Response toasts. -->
		<paper-toast id="deleteSuccess" duration="8000" text="Successfully deleted group."></paper-toast>
		<paper-toast id="deleteError" duration="8000" text="Error deleting group."></paper-toast>

	</template>
	<script>
		Polymer('delete-group', {

			deleteConfirmed: function () {
				this.$.deleteAPI.go();
			},

			deleteResponse: function () {
				this.$.deleteSuccess.show();
				this.fire('group-deleted');
			},

			deleteError: function (e, detail) {
				this.$.deleteError.text = detail.xhr.responseText;
				this.$.deleteError.show();
			},

			go: function(gid) {
				this.gid = gid;
				this.$.confirm.toggle();
			},
		});
	</script>
</polymer-element>