<!-- vim: set shiftwidth=2 tabstop=2 softtabstop=2 expandtab textwidth=72 : -->
<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../../bower_components/core-item/core-item.html"/>
<link rel="import" href="../../bower_components/core-selector/core-selector.html"/>
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html"/>

<polymer-element name="status-list" attributes="errors highlight">
  <template>
    <link rel="stylesheet" href="style.css"/>
    <link rel="stylesheet" href="status-list-style.css"/>

    <core-icon-button icon="backspace"
                      onclick="{{clearHighlighting}}"
                      label="Clear highlighting">
    </core-icon-button>
    <core-selector multi
                   id="selector"
                   selected="{{highlight}}"
                   valueattr="name">
      <template repeat="{{item in items}}">
        <core-item icon='{{item.icon}}'
                   name="{{item.className}}"
                   class="{{item.outcome}}"
                   label="{{item.problemDescription}}">
        </core-item>
      </template> 
    </core-selector>
    <p>
      {{tickerComments==null?"":tickerComments}}
    </p>
  </template>
  <script>
    Polymer('status-list'
      , {   highligh: []
          , errorsChanged:
            function ()
            {
              this.items =
                this.errors.map(
                    function (error)
                    {
                      switch (error.outcome)
                      {
                        case "PASS":
                          error.icon = "check";
                          break;

                        case "WARNING":
                          error.icon = "warning";
                          break;

                        default:
                          error.icon = "error";
                      }
                      return error;
                    });

              this.highlight =
              this.errors.filter(
                  function (error)
                  {
                    return (error.outcome == "ERROR"
                            || error.outcome == "WARNING")
                      && typeof error.className != typeof undefined;
                  }).map(
                    function (error)
                    {
                      return error.className;
                    });
            }

          , clearHighlighting:
            function ()
            {
              this.highlight = [];
            }
        });
  </script>
</polymer-element>
