<!-- vim: set shiftwidth=2 tabstop=2 softtabstop=2 expandtab textwidth=72 : -->
<link rel="import" href="../../bower_components/polymer/polymer.html"/>
<link rel="import" href="../../bower_components/core-item/core-item.html"/>
<link rel="import" href="../../bower_components/core-selector/core-selector.html"/>
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">

<polymer-element name="files-list"
                 attributes="files
                             selectedFileId
                             showHidden">
  <template>
    <link rel="stylesheet" href="../../css/shared-styles.css"/>
    <style>
      paper-checkbox + span
      {
        padding-left: 15px;
        margin-right: 20px;
      }
      [fileHidden=true]
      {
        color: #9e9e9e;
      }
    </style>
    <paper-checkbox checked="{{showHidden}}"></paper-checkbox>
    <span>Show hidden files</span>
    <core-selector id="selector"
                   selected="{{selectedFileId}}"
                   valueattr="id">
      <template repeat="{{file in files}}">
        <core-item icon="drive-file"
                   id="file{{file.id}}"
                   fileHidden="{{file.hidden && !showHidden}}"
                   label="{{file.name}}">
      </template>
    </core-selector>
  </template>
  <script>
    Polymer('files-list'
      , {   filesChanged:
            function ()
            {
              "use strict";
              /* Collapse common substrings
               * Changes
               * ["a/b/c", "a/b/d", "a/e/", "f"]
               *
               * to
               * [["a", "b", "c"], ["a", "b", "d"], ["a", "e"], ["f"]]
               *
               * then to
               * [["a", [["b", ["c", "d"]], "e"]], "f"]
               */
              this.files.sort();
              /*this.files.map(function (x) { return x.split("/"); });*/

              /* TODO: above collapse of common substrings. */
            }
        });
  </script>
</polymer-element>
