<!--
	! Dead buttons in top toolbar.
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="sidebar.html">
<link rel="import" href="onlogin.html">
<link rel="import" href="main-card.html">
<link rel="import" href="group.html">

<polymer-element name="my-scaffold">
	<template>
		<link rel="stylesheet" type="text/css" 
			href="../css/elements/scaff.css" shim-shadowdom>

			<!-- Run API calls. -->
			<on-login id="onlogin"></on-login>

			<core-scaffold mode="standard" id="scaffold">

				<!-- Sidebar element. -->
				<my-sidebar id="sidebar" navigation></my-sidebar>

				<!-- Top toolbar. -->
				<div flex tool layout horizontal center>
			  		<div>{{heading}}</div>
				  	<div flex horizontal end-justified layout center>
				  		<paper-button label="help"></paper-button>
				  		<paper-button label="logout" on-click="{{logoutClicked}}"></paper-button>
				  		<paper-icon-button icon="search"></paper-icon-button>
				  	</div>
			  	</div>

		  	<!-- Page Content -->
		  	<template id="groupTemplate" bind if="{{gid}}">
		  		<x-group gid="{{gid}}"></x-group>
		  	</template>

			</core-scaffold>
	</template>
	<script>
		Polymer('my-scaffold', {
			ready: function () {
			},	

			observe: {
				'$.sidebar.selected' : 'selectedChanged',
				'$.onlogin.sidebarItems' : 'sidebarItemsChanged'
			},

			// Handles changes in sidebar item selection (updates top toolbar heading).
			selectedChanged: function(oldValue, newValue) {
				this.$.groupTemplate.model = { gid: null };
				if (newValue.tagName === 'CORE-ITEM') {
					this.heading = newValue.label;
					this.currentGroupID = newValue.getAttribute('gid');
					this.$.groupTemplate.model = { gid: this.currentGroupID };
					console.log(this.currentGroupID);
				}
			},

		    // Handles logout button action. 
		    logoutClicked: function() {
		    	window.location.href = 'https://raven.cam.ac.uk/auth/logout.html'
		    },

		    // Handles changes in sidebar items list population. 
		    sidebarItemsChanged: function(oldValue, newValue) {
		    	this.$.sidebar.items = newValue;
		    }
		});
	</script>
</polymer-element>
